<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#121212">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="modern-financial-theme.css">
    <title>å†å²å›æµ‹ | CIO Dashboard</title>
    <style>
        /* å†å²å›æµ‹é¡µé¢ä¸“å± */
        .date-range { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; margin-bottom: 20px; }
        .date-range label { font-size: 12px; color: var(--text-muted); }
        .chart-container { position: relative; height: 360px; margin: 20px 0; }
        .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin: 20px 0; }
        .metrics-grid-6 { grid-template-columns: repeat(3, 1fr); }
        .chart-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .chart-half { min-width: 0; }
        .chart-small { height: 240px; }
        .flows-list, .anomaly-list { font-size: 13px; color: var(--text-muted); line-height: 1.8; }
        .flows-list li, .anomaly-list li { margin-bottom: 8px; padding-left: 16px; position: relative; }
        .flows-list li::before { content: "â€¢"; color: var(--primary); position: absolute; left: 0; }
        .anomaly-list li { border-left: 3px solid var(--danger); padding-left: 12px; margin-left: 4px; }
        .anomaly-hint { font-size: 12px; color: var(--text-muted); margin-top: 8px; }
        .timeline { position: relative; padding-left: 20px; border-left: 2px solid rgba(0,0,0,0.15); }
        .timeline-item { position: relative; padding: 8px 0; padding-left: 16px; }
        .timeline-item::before { content: ""; position: absolute; left: -25px; top: 14px; width: 8px; height: 8px; border-radius: 50%; background: var(--primary); }
        .timeline-item.deposit::before { background: var(--up); }
        .timeline-item.withdrawal::before { background: var(--down); }
        .data-table th { cursor: pointer; }
        .data-table th:hover { background: var(--bg-tertiary); }
        .data-table th.sorted-asc::after { content: " â†‘"; }
        .data-table th.sorted-desc::after { content: " â†“"; }
        .table-wrapper { max-height: 400px; overflow-y: auto; }
        @media (max-width: 768px) { .chart-row { grid-template-columns: 1fr; } .metrics-grid-6 { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 600px) { .chart-container { height: 280px; } .chart-small { height: 200px; } }
        .history-gate { transition: opacity 0.2s, filter 0.2s; }
        .history-gate.gated { pointer-events: none; user-select: none; }
        .history-gate.gated .value,
        .history-gate.gated .data-table td:not(:first-child),
        .history-gate.gated .timeline-item,
        .history-gate.gated .anomaly-list li,
        .history-gate.gated .chart-container { filter: blur(6px); user-select: none; }
        @media (max-width: 768px) { .history-gate .value { font-size: 14px; } .history-gate .metric-card { min-height: 60px; } }
    </style>
</head>
<body>
    <div id="loginStatus" onclick="handleStatusClick()"><span id="statusText"></span></div>
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <h2>ğŸ” æŸ¥çœ‹å®Œæ•´æ•°æ®</h2>
            <p style="color:var(--text-secondary);font-size:13px;margin-bottom:15px">å†å²å›æµ‹å«æ•æ„Ÿèµ„äº§æ•°æ®ï¼Œè¯·ç™»å½•åæŸ¥çœ‹</p>
            <input type="password" id="passwordInput" placeholder="è¯·è¾“å…¥å¯†ç " onkeypress="if(event.key==='Enter') login()">
            <button onclick="login()">æˆæƒ</button>
            <p id="loginError" style="color:var(--danger); margin-top:10px;"></p>
        </div>
    </div>
    <div id="tooltip" class="tooltip"></div>
    <nav class="nav-tabs tab-nav">
        <a href="index.html" class="nav-tab">æ¯æ—¥å¯¹è´¦</a>
        <a href="analysis.html" class="nav-tab">æ·±åº¦å½’å› </a>
        <a href="history.html" class="nav-tab active">å†å²å›æµ‹</a>
        <a href="knowledge.html" class="nav-tab">æŠ•èµ„å­—å…¸</a>
        <a href="screener.html" class="nav-tab">åŸºé‡‘ç­›é€‰</a>
    </nav>
    <div class="container history-gate" id="historyGate">
        <h1>å†å²å›æµ‹</h1>
        <div class="card">
            <h2>æ—¥æœŸèŒƒå›´</h2>
            <div class="date-range">
                <div>
                    <label for="dateStart">å¼€å§‹æ—¥æœŸ</label>
                    <input type="date" id="dateStart">
                </div>
                <div>
                    <label for="dateEnd">ç»“æŸæ—¥æœŸ</label>
                    <input type="date" id="dateEnd">
                </div>
                <button type="button" id="btnApply">åº”ç”¨</button>
                <button type="button" id="btnReset">é‡ç½®</button>
            </div>
            <h2>æ ¸å¿ƒæŒ‡æ ‡</h2>
            <div class="metrics-grid metrics-grid-6" id="metricsGrid">
                <div class="metric-card"><div class="label"><span class="glossary-term" data-tip="é€‰å®šåŒºé—´å†…ï¼Œæ‰£é™¤å¢æŠ•/èµå›åçš„æŠ•èµ„å›æŠ¥ç‡ã€‚">åŒºé—´æ”¶ç›Šç‡</span></div><div class="value" id="metricReturn">â€”</div></div>
                <div class="metric-card"><div class="label"><span class="glossary-term" data-tip="å°†åŒºé—´æ”¶ç›Šç‡æŒ‰å¹´åŒ–æŠ˜ç®—ï¼Œä¾¿äºè·¨å‘¨æœŸæ¯”è¾ƒã€‚">å¹´åŒ–æ”¶ç›Šç‡</span></div><div class="value" id="metricReturnAnn">â€”</div></div>
                <div class="metric-card"><div class="label"><span class="glossary-term" data-tip="å‡€å€¼ä»å†å²é«˜ç‚¹å›è½çš„ç™¾åˆ†æ¯”ï¼Œè¡¡é‡æœ€å¤§äºæŸå¹…åº¦ã€‚">æœ€å¤§å›æ’¤</span></div><div class="value" id="metricDrawdown">â€”</div></div>
                <div class="metric-card"><div class="label"><span class="glossary-term" data-tip="å•ä½é£é™©è·å¾—çš„è¶…é¢æ”¶ç›Šï¼Œè¶Šé«˜è¯´æ˜é£é™©è°ƒæ•´åæ”¶ç›Šè¶Šå¥½ã€‚">å¤æ™®æ¯”ç‡</span></div><div class="value" id="metricSharpe">â€”</div></div>
                <div class="metric-card"><div class="label"><span class="glossary-term" data-tip="ç›ˆåˆ©äº¤æ˜“æ—¥å æ¯”ï¼Œå¦‚ 60% è¡¨ç¤º 10 å¤©ä¸­æœ‰ 6 å¤©èµšé’±ã€‚">èƒœç‡</span></div><div class="value" id="metricWinRate">â€”</div></div>
                <div class="metric-card"><div class="label"><span class="glossary-term" data-tip="å¹³å‡ç›ˆåˆ©æ—¥æ”¶ç›Š Ã· å¹³å‡äºæŸæ—¥æ”¶ç›Šï¼Œè¡¡é‡ç›ˆäºä¸å¯¹ç§°æ€§ã€‚">ç›ˆäºæ¯”</span></div><div class="value" id="metricProfitLoss">â€”</div></div>
            </div>
            <div class="metrics-grid" style="margin-top:0">
                <div class="metric-card"><div class="label">æœŸåˆå¸‚å€¼</div><div class="value" id="metricStartMv">â€”</div></div>
                <div class="metric-card"><div class="label">æœŸæœ«å¸‚å€¼</div><div class="value" id="metricEndMv">â€”</div></div>
                <div class="metric-card"><div class="label"><span class="glossary-term" data-tip="(æœŸæœ«å¸‚å€¼ - æœŸåˆå¸‚å€¼) - å‡€æµå…¥ï¼Œæ’é™¤å¢æŠ•/èµå›åçš„çº¯æŠ•èµ„å›æŠ¥ã€‚">çœŸå®æ”¶ç›Š</span></div><div class="value" id="metricPnl">â€”</div></div>
                <div class="metric-card"><div class="label"><span class="glossary-term" data-tip="æœŸé—´ä¹°å…¥æ€»é¢ - å–å‡ºæ€»é¢ï¼Œæ­£æ•°è¡¨ç¤ºå‡€æŠ•å…¥èµ„é‡‘ã€‚">å‡€æµå…¥</span></div><div class="value" id="metricNetInflow">â€”</div></div>
            </div>
            <h2>å‡€å€¼æ›²çº¿ + å›æ’¤</h2>
            <div class="chart-container">
                <canvas id="pnlChart"></canvas>
            </div>
            <div class="chart-row">
                <div class="chart-half">
                    <h2>æ”¶ç›Šåˆ†å¸ƒ</h2>
                    <div class="chart-container chart-small"><canvas id="histogramChart"></canvas></div>
                </div>
                <div class="chart-half">
                    <h2>30æ—¥æ»šåŠ¨æ³¢åŠ¨ç‡</h2>
                    <div class="chart-container chart-small"><canvas id="volatilityChart"></canvas></div>
                </div>
            </div>
            <h2>èµ„é‡‘æµæ°´æ—¶é—´è½´</h2>
            <p class="anomaly-hint">åœ¨ capital_flows.json ä¸­è®°å½•å¢æŠ•/èµå›ï¼Œä¾¿äºæ”¶ç›Šè®¡ç®—æ›´å‡†ç¡®ã€‚</p>
            <div class="timeline" id="flowsTimeline"></div>
            <h2>ç–‘ä¼¼å¢æŠ•/èµå›ï¼ˆæ™ºèƒ½æ£€æµ‹ï¼‰</h2>
            <p class="anomaly-hint">å•æ—¥å¸‚å€¼å˜åŒ–è¶…è¿‡ Â±15% çš„æ—¥æœŸï¼Œè¯·ç¡®è®¤æ˜¯å¦å·²åœ¨ capital_flows.json ä¸­è®°å½•ã€‚</p>
            <ul class="anomaly-list" id="anomalyList"></ul>
            <h2>æ¯æ—¥æ•°æ®</h2>
            <input type="text" class="table-search" id="tableSearch" placeholder="æœç´¢æ—¥æœŸ...">
            <div class="table-wrapper">
                <table class="data-table" id="dailyTable">
                    <thead><tr><th data-sort="date">æ—¥æœŸ</th><th data-sort="mv">å¸‚å€¼</th><th data-sort="dailyRet">æ—¥æ”¶ç›Šç‡</th><th data-sort="cumRet">ç´¯è®¡æ”¶ç›Šç‡</th><th data-sort="dd">å›æ’¤</th></tr></thead>
                    <tbody id="dailyTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/template" id="capital-flows-data">[{"date": "2026-01-08", "type": "withdrawal", "amount": 470.69, "note": "å–å‡ºåˆ›æ–°è¯(è½¬å…¥æ²ªæ·±)"}, {"date": "2026-01-08", "type": "withdrawal", "amount": 470.67, "note": "å–å‡ºåˆ›æ–°è¯(è½¬å…¥æ²ªæ·±)"}, {"date": "2026-01-09", "type": "withdrawal", "amount": 732.85, "note": "å–å‡ºä¸­è¯ç™½é…’(ç»™æœ‰è‰²é‡‘å±)"}, {"date": "2026-01-13", "type": "deposit", "amount": 400, "note": "å®šæŠ•çº³æ–¯è¾¾å…‹(13-23åˆè®¡)"}, {"date": "2026-01-14", "type": "withdrawal", "amount": 375.23, "note": "å–å‡ºåå¤æˆ¿åœ°äº§(ç»™æ²ªæ·±300)"}, {"date": "2026-01-14", "type": "deposit", "amount": 500, "note": "ä¹°å…¥äººå·¥æ™ºèƒ½"}, {"date": "2026-01-18", "type": "withdrawal", "amount": 611.09, "note": "å–å‡ºæœ‰è‰²é‡‘å±(ç»™äººå·¥æ™ºèƒ½)"}, {"date": "2026-01-21", "type": "deposit", "amount": 500, "note": "ä¹°å…¥äººå·¥æ™ºèƒ½"}, {"date": "2026-01-21", "type": "withdrawal", "amount": 801.25, "note": "å–å‡ºä¸Šæµ·é‡‘"}, {"date": "2026-01-30", "type": "deposit", "amount": 2000, "note": "ä¹°å…¥æœ‰è‰²é‡‘å±"}, {"date": "2026-01-30", "type": "deposit", "amount": 1500, "note": "ä¹°å…¥ä¸Šæµ·é‡‘"}, {"date": "2026-02-12", "type": "deposit", "amount": 2000, "note": "å¢æŠ•çº¢åˆ©ä½æ³¢"}]</script>
    <script type="text/template" id="history-data">[{"date": "2026-01-14", "total_mv": "16800.0", "daily_pnl": "-50.0", "account_a_mv": "8500.0", "account_b_mv": "8300.0"}, {"date": "2026-01-15", "total_mv": "16850.0", "daily_pnl": "50.0", "account_a_mv": "8520.0", "account_b_mv": "8330.0"}, {"date": "2026-01-16", "total_mv": "16834.8", "daily_pnl": "-15.2", "account_a_mv": "8510.0", "account_b_mv": "8324.8"}, {"date": "2026-01-17", "total_mv": "16832.63", "daily_pnl": "-42.57", "account_a_mv": "10600.4", "account_b_mv": "6232.23"}, {"date": "2026-01-17 02:24", "total_mv": "17248.894283653834", "daily_pnl": "-23.327106895", "account_a_mv": "11016.66377765383", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 02:38", "total_mv": "17250.928361281567", "daily_pnl": "-23.327106895", "account_a_mv": "11018.697855281564", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 02:45", "total_mv": "17252.238947741418", "daily_pnl": "-23.327106895", "account_a_mv": "11020.008441741418", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 02:54", "total_mv": "17248.147071464053", "daily_pnl": "-23.327106895", "account_a_mv": "11015.916565464053", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 11:45", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 11:46", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 11:52", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 12:26", "total_mv": "17136.543049347263", "daily_pnl": "-28.36600905900456", "account_a_mv": "10904.31254334726", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 12:36", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 12:38", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 12:39", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 12:43", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 12:49", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 12:50", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 12:51", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 12:55", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 13:02", "total_mv": "17246.757689347265", "daily_pnl": "-41.26114357800456", "account_a_mv": "11014.527183347263", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 13:41", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 14:55", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 15:32", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 16:49", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 16:51", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 16:54", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 17:59", "total_mv": "38000.0", "daily_pnl": "290.0", "account_a_mv": "25000.0", "account_b_mv": "13000.0"}, {"date": "2026-01-17 18:05", "total_mv": "38000.0", "daily_pnl": "290.0", "account_a_mv": "25000.0", "account_b_mv": "13000.0"}, {"date": "2026-01-17 18:14", "total_mv": "15880.858253372511", "daily_pnl": "26.886301372513287", "account_a_mv": "9908.290320065866", "account_b_mv": "5972.567933306647"}, {"date": "2026-01-17 18:31", "total_mv": "15824.136095974847", "daily_pnl": "-29.83585602515194", "account_a_mv": "9829.790895441609", "account_b_mv": "5994.345200533238"}, {"date": "2026-01-17 18:42", "total_mv": "15746.448392131942", "daily_pnl": "-107.52355986805588", "account_a_mv": "9781.879926309975", "account_b_mv": "5964.568465821963"}, {"date": "2026-01-17 19:08", "total_mv": "15972.52", "daily_pnl": "118.55", "account_a_mv": "9889.44", "account_b_mv": "6083.08"}, {"date": "2026-01-17 19:28", "total_mv": "15852.13", "daily_pnl": "-1.84", "account_a_mv": "9773.48", "account_b_mv": "6078.66"}, {"date": "2026-01-17 19:43", "total_mv": "15805.25", "daily_pnl": "-48.72", "account_a_mv": "9833.3", "account_b_mv": "5971.95"}, {"date": "2026-01-17 20:33", "total_mv": "15767.08", "daily_pnl": "-86.89", "account_a_mv": "9825.06", "account_b_mv": "5942.02"}, {"date": "2026-01-17 20:46", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 21:27", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 21:35", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 21:36", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 22:16", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 22:39", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 22:42", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 22:46", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-17 23:35", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 00:44", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 01:33", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 02:52", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 03:26", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 03:39", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 04:39", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 05:31", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 06:40", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 07:33", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 12:00", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 13:03", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 13:52", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 14:56", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 15:33", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 16:50", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 17:38", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 18:42", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 19:28", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 19:43", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 21:37", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 22:38", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 22:40", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-18 23:34", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 00:48", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 01:35", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 02:51", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 03:27", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 03:41", "total_mv": "17243.37744372683", "daily_pnl": "-44.60417776558684", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 04:40", "total_mv": "17243.37744372683", "daily_pnl": "-27.924275155", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 05:31", "total_mv": "17243.37744372683", "daily_pnl": "-27.924275155", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 06:40", "total_mv": "17243.37744372683", "daily_pnl": "-27.924275155", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 07:34", "total_mv": "17243.37744372683", "daily_pnl": "-27.924275155", "account_a_mv": "11011.146937726828", "account_b_mv": "6232.230506"}, {"date": "2026-01-19 10:25", "total_mv": "17272.454679726827", "daily_pnl": "19.5111918833", "account_a_mv": "11029.40341172683", "account_b_mv": "6243.051268"}, {"date": "2026-01-19 11:21", "total_mv": "17256.98032472683", "daily_pnl": "4.144614981800001", "account_a_mv": "11018.355776726828", "account_b_mv": "6238.624548"}, {"date": "2026-01-19 13:08", "total_mv": "17296.86097966838", "daily_pnl": "44.63161610976684", "account_a_mv": "11062.513876668383", "account_b_mv": "6234.347103"}, {"date": "2026-01-19 13:51", "total_mv": "17300.857806507796", "daily_pnl": "48.66756318773115", "account_a_mv": "11063.254638507797", "account_b_mv": "6237.603168"}, {"date": "2026-01-19 13:52", "total_mv": "17294.886173507795", "daily_pnl": "43.10202923213115", "account_a_mv": "11059.083548507797", "account_b_mv": "6235.802625"}, {"date": "2026-01-19 14:00", "total_mv": "17278.39773942021", "daily_pnl": "26.15433621048184", "account_a_mv": "11051.142362420209", "account_b_mv": "6227.255377"}, {"date": "2026-01-19 15:45", "total_mv": "17300.218959770573", "daily_pnl": "47.87359718059005", "account_a_mv": "11065.501689770572", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 17:55", "total_mv": "17301.464313420205", "daily_pnl": "49.16114553868182", "account_a_mv": "11066.747043420204", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 19:16", "total_mv": "17298.08406779977", "daily_pnl": "45.6690194815355", "account_a_mv": "11063.36679779977", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 19:30", "total_mv": "17297.550344807074", "daily_pnl": "45.11839769973346", "account_a_mv": "11062.833074807071", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 21:27", "total_mv": "17302.47245685086", "daily_pnl": "50.20428023825663", "account_a_mv": "11067.75518685086", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 21:40", "total_mv": "17303.006179843564", "daily_pnl": "50.75682999187308", "account_a_mv": "11068.28890984356", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 21:57", "total_mv": "17301.049195536994", "daily_pnl": "48.731836285959645", "account_a_mv": "11066.331925536992", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 22:03", "total_mv": "17299.38872400415", "daily_pnl": "47.01586394198918", "account_a_mv": "11064.67145400415", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 22:18", "total_mv": "17297.66894991656", "daily_pnl": "45.24074002901912", "account_a_mv": "11062.95167991656", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 22:27", "total_mv": "17298.261975464004", "daily_pnl": "45.85260653262127", "account_a_mv": "11063.544705464004", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 22:30", "total_mv": "17300.930590427506", "daily_pnl": "48.60919972804295", "account_a_mv": "11066.213320427503", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 22:45", "total_mv": "17300.218959770573", "daily_pnl": "47.87359718059005", "account_a_mv": "11065.501689770572", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 22:46", "total_mv": "17300.45616998955", "daily_pnl": "48.11875673449528", "account_a_mv": "11065.73889998955", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 22:57", "total_mv": "17300.04105210634", "daily_pnl": "47.68975461516736", "account_a_mv": "11065.323782106338", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 23:05", "total_mv": "17300.811985318018", "daily_pnl": "48.486573493938494", "account_a_mv": "11066.094715318017", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 23:12", "total_mv": "17300.69338020853", "daily_pnl": "48.36395758364624", "account_a_mv": "11065.976110208529", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-19 23:52", "total_mv": "17301.22710320123", "daily_pnl": "48.91581047998015", "account_a_mv": "11066.509833201228", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-20 00:59", "total_mv": "17303.59920539101", "daily_pnl": "51.371019353083724", "account_a_mv": "11068.881935391006", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-20 01:48", "total_mv": "17303.421297726774", "daily_pnl": "51.18673544471541", "account_a_mv": "11068.704027726772", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-20 02:58", "total_mv": "17306.32712290925", "daily_pnl": "54.199614681986304", "account_a_mv": "11071.60985290925", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-20 03:33", "total_mv": "17302.05733896765", "daily_pnl": "49.774663852138914", "account_a_mv": "11067.34006896765", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-20 04:43", "total_mv": "17302.88757473407", "daily_pnl": "50.63402309106573", "account_a_mv": "11068.17030473407", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-20 05:36", "total_mv": "17302.88757473407", "daily_pnl": "50.63402309106573", "account_a_mv": "11068.17030473407", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-20 06:44", "total_mv": "17302.286074734075", "daily_pnl": "50.63444414106573", "account_a_mv": "11067.568804734072", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-20 07:38", "total_mv": "17299.32094699685", "daily_pnl": "47.56762685964984", "account_a_mv": "11064.603676996849", "account_b_mv": "6234.717270000001"}, {"date": "2026-01-20 10:27", "total_mv": "17167.956560332615", "daily_pnl": "-115.41158646438002", "account_a_mv": "10949.575948332616", "account_b_mv": "6218.380612"}, {"date": "2026-01-20 12:00", "total_mv": "17263.254406799762", "daily_pnl": "-22.66446682394566", "account_a_mv": "11027.306327799764", "account_b_mv": "6235.948079"}, {"date": "2026-01-20 13:18", "total_mv": "17305.474092748653", "daily_pnl": "19.7401006187386", "account_a_mv": "11075.276484748654", "account_b_mv": "6230.197608"}, {"date": "2026-01-20 13:58", "total_mv": "17358.127592653753", "daily_pnl": "72.8204208756029", "account_a_mv": "11114.173032653753", "account_b_mv": "6243.95456"}, {"date": "2026-01-20 15:05", "total_mv": "17351.976039157402", "daily_pnl": "66.88594673067674", "account_a_mv": "11112.9501371574", "account_b_mv": "6239.025902"}, {"date": "2026-01-20 15:55", "total_mv": "17357.033159113602", "daily_pnl": "72.13115612463993", "account_a_mv": "11116.185389113602", "account_b_mv": "6240.84777"}, {"date": "2026-01-20 17:03", "total_mv": "17361.851465602645", "daily_pnl": "77.18351174623938", "account_a_mv": "11120.982370602647", "account_b_mv": "6240.869095"}, {"date": "2026-01-20 17:59", "total_mv": "17366.71427509169", "daily_pnl": "82.3483288577277", "account_a_mv": "11125.845180091694", "account_b_mv": "6240.869095"}, {"date": "2026-01-20 18:50", "total_mv": "17359.47936341287", "daily_pnl": "74.67038629009775", "account_a_mv": "11118.610268412873", "account_b_mv": "6240.869095"}, {"date": "2026-01-20 18:58", "total_mv": "17359.24215319389", "daily_pnl": "74.41930086833864", "account_a_mv": "11118.373058193893", "account_b_mv": "6240.869095"}, {"date": "2026-01-20 19:43", "total_mv": "17361.199137500458", "daily_pnl": "76.49199058381282", "account_a_mv": "11120.330042500458", "account_b_mv": "6240.869095"}, {"date": "2026-01-20 21:58", "total_mv": "17361.61425538367", "daily_pnl": "76.93201337201715", "account_a_mv": "11120.74516038367", "account_b_mv": "6240.869095"}, {"date": "2026-01-20 23:02", "total_mv": "17367.54451085811", "daily_pnl": "83.2318613015007", "account_a_mv": "11126.675415858115", "account_b_mv": "6240.869095"}, {"date": "2026-01-20 23:03", "total_mv": "17367.010787865416", "daily_pnl": "82.66381808763506", "account_a_mv": "11126.141692865416", "account_b_mv": "6240.869095"}, {"date": "2026-01-22 12:59:43", "total_mv": "17563.894207865374", "daily_pnl": "0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-01-22 13:28:20", "total_mv": "17594.223559507707", "daily_pnl": "0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-01-22 16:51:11", "total_mv": "17649.610300186527", "daily_pnl": "0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-01-22 17:03:52", "total_mv": "17651.211469164627", "daily_pnl": "0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 18:37", "total_mv": "16945.299279000003", "daily_pnl": "-705.9122", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 19:22", "total_mv": "16945.299279000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 20:43", "total_mv": "16908.868179", "daily_pnl": "-36.4311", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 21:33", "total_mv": "16550.928416", "daily_pnl": "-357.9398", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 21:37", "total_mv": "16511.016001", "daily_pnl": "-39.9124", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 21:42", "total_mv": "16945.299279000003", "daily_pnl": "434.2833", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 21:43", "total_mv": "16945.299279000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 21:52", "total_mv": "20285.699267999997", "daily_pnl": "3340.4", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 22:22", "total_mv": "20285.699267999997", "daily_pnl": "-0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-02 23:54", "total_mv": "20285.699267999997", "daily_pnl": "-0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-03 12:05", "total_mv": "20209.279323", "daily_pnl": "-76.4199", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-03 13:29", "total_mv": "20263.537417", "daily_pnl": "54.2581", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-03 13:38", "total_mv": "20303.499327999998", "daily_pnl": "39.9619", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-03 15:55", "total_mv": "20311.526857999997", "daily_pnl": "8.0275", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-03 17:09", "total_mv": "20312.220721", "daily_pnl": "0.6939", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-04 00:38", "total_mv": "20312.220721", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-04 12:32", "total_mv": "20315.544286", "daily_pnl": "3.3236", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-04 13:18", "total_mv": "20317.438856", "daily_pnl": "1.8946", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-04 15:56", "total_mv": "20318.970166", "daily_pnl": "1.5313", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-04 18:04", "total_mv": "20319.399693", "daily_pnl": "0.4295", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-05 00:10", "total_mv": "20319.399693", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-05 12:07", "total_mv": "19755.200381", "daily_pnl": "-564.1993", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-05 13:22", "total_mv": "19713.435433", "daily_pnl": "-41.7649", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-05 15:58", "total_mv": "19912.422403", "daily_pnl": "198.987", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-05 18:05", "total_mv": "19912.328267", "daily_pnl": "-0.0941", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-06 00:01", "total_mv": "19912.328267", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-06 11:29", "total_mv": "19950.099815", "daily_pnl": "37.7715", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-06 14:12", "total_mv": "19962.640405000002", "daily_pnl": "12.5406", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-06 16:02", "total_mv": "19948.709376", "daily_pnl": "-13.931", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-06 22:34", "total_mv": "19948.947772", "daily_pnl": "0.2384", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-07 00:00", "total_mv": "19948.947772", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-07 00:01", "total_mv": "19948.947772", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-07 11:23", "total_mv": "19976.743351999998", "daily_pnl": "27.7956", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-07 14:03", "total_mv": "19976.743351999998", "daily_pnl": "-0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-07 15:52", "total_mv": "19976.743351999998", "daily_pnl": "-0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-07 22:17", "total_mv": "19976.743351999998", "daily_pnl": "-0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-08 11:52", "total_mv": "19976.743351999998", "daily_pnl": "-0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-08 14:12", "total_mv": "19976.743351999998", "daily_pnl": "-0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-08 15:56", "total_mv": "19976.743351999998", "daily_pnl": "-0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-08 22:18", "total_mv": "19931.469992", "daily_pnl": "-45.2734", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-09 11:41", "total_mv": "20302.777801", "daily_pnl": "371.3078", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-09 14:42", "total_mv": "20328.716631", "daily_pnl": "25.9388", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-09 16:07", "total_mv": "20254.457862000003", "daily_pnl": "-74.2588", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-09 22:05", "total_mv": "20254.457862000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-09 22:45", "total_mv": "20254.457862000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-09 23:05", "total_mv": "20254.457862000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-09 23:07", "total_mv": "20254.457862000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-09 23:08", "total_mv": "20254.457862000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-10 11:48", "total_mv": "20135.925707000002", "daily_pnl": "-118.5322", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-10 14:43", "total_mv": "20165.169618", "daily_pnl": "29.2439", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-10 16:08", "total_mv": "20169.513377", "daily_pnl": "4.3438", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-10 22:51", "total_mv": "20154.833833", "daily_pnl": "-14.6795", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-11 11:46", "total_mv": "20247.147078", "daily_pnl": "92.3132", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-11 11:48", "total_mv": "20247.147078", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-11 14:40", "total_mv": "20211.390177", "daily_pnl": "-35.7569", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-11 16:06", "total_mv": "20188.529541", "daily_pnl": "-22.8606", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-11 22:46", "total_mv": "20188.529541", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-12 10:13", "total_mv": "20446.65176", "daily_pnl": "258.1222", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-12 11:40", "total_mv": "20432.824446", "daily_pnl": "-13.8273", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-12 14:39", "total_mv": "20400.926987", "daily_pnl": "-31.8975", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-12 16:04", "total_mv": "20414.694464", "daily_pnl": "13.7675", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-12 21:41", "total_mv": "20414.694464", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-12 22:09", "total_mv": "20414.694464", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-17 23:41", "total_mv": "20099.263843", "daily_pnl": "-315.4306", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 00:12", "total_mv": "20099.263843", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 00:17", "total_mv": "20099.263843", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 00:17", "total_mv": "20099.263843", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 11:36", "total_mv": "20095.350873000003", "daily_pnl": "-3.913", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 14:38", "total_mv": "20095.350873000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 14:57", "total_mv": "19970.979763000003", "daily_pnl": "-124.3711", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 15:42", "total_mv": "20095.350873000003", "daily_pnl": "124.3711", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 15:43", "total_mv": "19955.058022999998", "daily_pnl": "-140.2929", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 17:43", "total_mv": "20095.350873000003", "daily_pnl": "140.2929", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 17:43", "total_mv": "20095.350873000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 17:44", "total_mv": "20095.350873000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 19:16", "total_mv": "20095.350873000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 19:49", "total_mv": "20095.350873000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 19:50", "total_mv": "20095.350873000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 20:04", "total_mv": "19342.291684", "daily_pnl": "-753.0592", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 20:22", "total_mv": "20095.350873000003", "daily_pnl": "753.0592", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 20:23", "total_mv": "19801.306021999997", "daily_pnl": "-294.0449", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 20:25", "total_mv": "20095.350873000003", "daily_pnl": "294.0449", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 20:26", "total_mv": "20095.350873000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 20:50", "total_mv": "20866.124957", "daily_pnl": "770.7741", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 20:51", "total_mv": "20866.124957", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 21:19", "total_mv": "20866.124957", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 21:20", "total_mv": "20866.124957", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 21:33", "total_mv": "20672.609257", "daily_pnl": "-193.5157", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 21:52", "total_mv": "20866.124957", "daily_pnl": "193.5157", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 22:01", "total_mv": "20929.469549", "daily_pnl": "63.3446", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 22:02", "total_mv": "20947.086617", "daily_pnl": "17.6171", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 22:25", "total_mv": "22105.215557000003", "daily_pnl": "1158.1289", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 22:26", "total_mv": "22105.215557000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 22:41", "total_mv": "22105.215557000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 22:42", "total_mv": "22105.215557000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 23:01", "total_mv": "22105.215557000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-18 23:02", "total_mv": "22105.215557000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-19 00:05", "total_mv": "22105.215557000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-19 00:05", "total_mv": "22105.215557000003", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-19 22:10", "total_mv": "22117.379723", "daily_pnl": "12.1642", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-19 22:11", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-19 22:52", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-19 22:53", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 00:21", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 00:22", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 00:35", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 00:36", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 01:36", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 01:42", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 01:43", "total_mv": "22117.379723", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 14:21", "total_mv": "22101.51038", "daily_pnl": "-15.8693", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 14:35", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 14:42", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 14:44", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 16:06", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 16:07", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 17:51", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 17:52", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 22:03", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 22:04", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 22:36", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 22:37", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 22:53", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 22:54", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 23:54", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-20 23:55", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-21 01:06", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-21 01:07", "total_mv": "22101.51038", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-21 21:32", "total_mv": "22118.28854", "daily_pnl": "16.7782", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-21 21:33", "total_mv": "22118.28854", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-21 23:49", "total_mv": "22118.28854", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-21 23:51", "total_mv": "22118.28854", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-22 00:52", "total_mv": "22118.28854", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-22 00:53", "total_mv": "22118.28854", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-22 01:40", "total_mv": "22118.28854", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-22 01:41", "total_mv": "22118.28854", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}, {"date": "2026-02-23 12:05", "total_mv": "22118.28854", "daily_pnl": "0.0", "account_a_mv": "0", "account_b_mv": "0"}]</script>
    <script>
        const PASSWORD_HASH = "608f4a69d48963560e8c0fcb2f6da1a51e87b117dcf1b3054038f7cbd8660def";
        let HISTORY_RAW = [];
        let CAPITAL_FLOWS = [];
        try {
            const dataEl = document.getElementById('history-data');
            HISTORY_RAW = JSON.parse(dataEl ? dataEl.textContent : '[]');
        } catch (e) { console.warn('å†å²æ•°æ®è§£æå¤±è´¥', e); }
        try {
            const flowsEl = document.getElementById('capital-flows-data');
            CAPITAL_FLOWS = JSON.parse(flowsEl ? flowsEl.textContent : '[]');
        } catch (e) { console.warn('èµ„é‡‘æµæ°´è§£æå¤±è´¥', e); }

        const ANOMALY_THRESHOLD = 15;  // å•æ—¥å¸‚å€¼å˜åŒ– Â±15% è§†ä¸ºå¼‚å¸¸

        // æŒ‰æ—¥æœŸèšåˆï¼šæ¯æ—¥å–æœ€åä¸€ä¸ªå¿«ç…§ï¼ˆæŒ‰ date æ’åºåï¼ŒåŒæ—¥æœŸåè€…è¦†ç›–å‰è€…ï¼‰
        function aggregateDaily(raw) {
            const sorted = [...raw].sort((a, b) => (a.date || '').localeCompare(b.date || ''));
            const byDate = {};
            sorted.forEach(row => {
                const d = (row.date || '').split(' ')[0];
                if (!d) return;
                byDate[d] = { date: d, total_mv: parseFloat(row.total_mv) || 0, daily_pnl: parseFloat(row.daily_pnl) || 0 };
            });
            return Object.values(byDate).sort((a, b) => a.date.localeCompare(b.date));
        }

        let chartInstance = null;
        let histogramInstance = null;
        let volatilityInstance = null;

        function renderChart(filtered) {
            const ctx = document.getElementById('pnlChart').getContext('2d');
            if (chartInstance) chartInstance.destroy();

            if (!filtered.length) return;
            const first = filtered[0].total_mv;
            const labels = filtered.map(d => d.date);
            const nav = filtered.map(d => first > 0 ? d.total_mv / first : 1);
            let peak = first;
            const drawdown = filtered.map(d => {
                if (d.total_mv > peak) peak = d.total_mv;
                return peak > 0 ? (peak - d.total_mv) / peak * 100 : 0;
            });

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels,
                    datasets: [
                        { label: 'å‡€å€¼', data: nav, borderColor: '#d4af37', backgroundColor: 'rgba(212, 175, 55, 0.1)', fill: true, tension: 0.3, pointRadius: 2, yAxisID: 'y' },
                        { label: 'å›æ’¤ (%)', data: drawdown, borderColor: '#f44336', backgroundColor: 'rgba(244, 67, 54, 0.1)', fill: true, tension: 0.3, pointRadius: 2, yAxisID: 'y1' }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    scales: {
                        x: { ticks: { color: '#b0b0b0', maxRotation: 45 }, grid: { color: '#3a3a3a' } },
                        y: { type: 'linear', position: 'left', ticks: { color: '#b0b0b0' }, grid: { color: '#3a3a3a' } },
                        y1: { type: 'linear', position: 'right', ticks: { color: '#f44336', callback: v => v + '%' }, grid: { display: false } }
                    }
                }
            });
        }

        function renderHistogram(filtered) {
            const ctx = document.getElementById('histogramChart');
            if (!ctx) return;
            if (histogramInstance) histogramInstance.destroy();

            const dailyRets = [];
            for (let i = 1; i < filtered.length; i++) {
                const prev = filtered[i-1].total_mv;
                const curr = filtered[i].total_mv;
                if (prev > 0) dailyRets.push((curr - prev) / prev * 100);
            }
            if (!dailyRets.length) return;

            const boundaries = [-Infinity, -5, -2, -1, -0.5, 0, 0.5, 1, 2, 5, Infinity];
            const labels = ['<-5%', '-5~-2%', '-2~-1%', '-1~-0.5%', '-0.5~0%', '0~0.5%', '0.5~1%', '1~2%', '2~5%', '>5%'];
            const counts = labels.map(() => 0);
            dailyRets.forEach(r => {
                for (let j = 0; j < boundaries.length - 1; j++) {
                    if (r >= boundaries[j] && r < boundaries[j + 1]) { counts[j]++; break; }
                }
            });

            histogramInstance = new Chart(ctx.getContext('2d'), {
                type: 'bar',
                data: { labels, datasets: [{ label: 'å¤©æ•°', data: counts, backgroundColor: 'rgba(212, 175, 55, 0.6)', borderColor: '#d4af37', borderWidth: 1 }] },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { ticks: { color: '#b0b0b0', maxRotation: 45, font: { size: 10 } }, grid: { color: '#3a3a3a' } },
                        y: { ticks: { color: '#b0b0b0' }, grid: { color: '#3a3a3a' } }
                    }
                }
            });
        }

        function renderVolatility(filtered) {
            const ctx = document.getElementById('volatilityChart');
            if (!ctx) return;
            if (volatilityInstance) volatilityInstance.destroy();

            const dailyRets = [];
            for (let i = 1; i < filtered.length; i++) {
                const prev = filtered[i-1].total_mv;
                const curr = filtered[i].total_mv;
                if (prev > 0) dailyRets.push((curr - prev) / prev * 100);
            }
            const win = 30;
            const labels = filtered.slice(win).map(d => d.date);
            const vol = [];
            for (let i = win; i <= dailyRets.length; i++) {
                const slice = dailyRets.slice(i - win, i);
                const avg = slice.reduce((a,b)=>a+b,0)/slice.length;
                const std = slice.length > 1 ? Math.sqrt(slice.reduce((s,r)=>s+(r-avg)**2,0)/(slice.length-1)) : 0;
                vol.push(std);
            }
            if (!labels.length) return;

            volatilityInstance = new Chart(ctx.getContext('2d'), {
                type: 'line',
                data: {
                    labels,
                    datasets: [{ label: '30æ—¥æ³¢åŠ¨ç‡ (%)', data: vol, borderColor: '#2ecc71', backgroundColor: 'rgba(46, 204, 113, 0.1)', fill: true, tension: 0.3, pointRadius: 1 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { ticks: { color: '#b0b0b0', maxRotation: 45 }, grid: { color: '#3a3a3a' } },
                        y: { ticks: { color: '#b0b0b0', callback: v => v + '%' }, grid: { color: '#3a3a3a' } }
                    }
                }
            });
        }

        function renderDailyTable(filtered) {
            const tbody = document.getElementById('dailyTableBody');
            const search = (document.getElementById('tableSearch') || {}).value || '';
            if (!tbody) return;

            let rows = filtered.map((d, i) => {
                const prev = i > 0 ? filtered[i-1].total_mv : d.total_mv;
                const dailyRet = prev > 0 ? (d.total_mv - prev) / prev * 100 : 0;
                const first = filtered[0].total_mv;
                const cumRet = first > 0 ? (d.total_mv / first - 1) * 100 : 0;
                let peak = first;
                for (let j = 0; j <= i; j++) {
                    if (filtered[j].total_mv > peak) peak = filtered[j].total_mv;
                }
                const dd = peak > 0 ? (peak - d.total_mv) / peak * 100 : 0;
                return { date: d.date, mv: d.total_mv, dailyRet, cumRet, dd };
            });
            if (search) rows = rows.filter(r => r.date.includes(search));
            if (tableSortCol) {
                rows.sort((a, b) => {
                    const va = a[tableSortCol], vb = b[tableSortCol];
                    const cmp = typeof va === 'string' ? va.localeCompare(vb) : (va - vb);
                    return tableSortDir * cmp;
                });
            }

            tbody.innerHTML = rows.map(r => {
                const retCls = r.dailyRet >= 0 ? 'up' : 'down';
                return `<tr><td>${r.date}</td><td>Â¥${r.mv.toLocaleString('zh-CN',{maximumFractionDigits:2})}</td><td class="${retCls}">${(r.dailyRet>=0?'+':'')+r.dailyRet.toFixed(2)}%</td><td>${(r.cumRet>=0?'+':'')+r.cumRet.toFixed(2)}%</td><td>${r.dd.toFixed(2)}%</td></tr>`;
            }).join('');
        }

        let tableSortCol = null;
        let tableSortDir = 1;
        document.addEventListener('DOMContentLoaded', () => {
            const ths = document.querySelectorAll('#dailyTable th[data-sort]');
            ths.forEach(th => {
                th.addEventListener('click', () => {
                    const col = th.getAttribute('data-sort');
                    tableSortDir = tableSortCol === col ? -tableSortDir : 1;
                    tableSortCol = col;
                    ths.forEach(t => { t.classList.remove('sorted-asc','sorted-desc'); });
                    th.classList.add(tableSortDir > 0 ? 'sorted-asc' : 'sorted-desc');
                    applyFilter();
                });
            });
            document.getElementById('tableSearch')?.addEventListener('input', applyFilter);
        });

        function daysBetween(d1, d2) {
            const a = typeof d1 === 'string' ? new Date(d1) : d1;
            const b = typeof d2 === 'string' ? new Date(d2) : d2;
            return Math.max(0, Math.round((b - a) / (24 * 60 * 60 * 1000)));
        }

        function getFlowsInRange(start, end) {
            return CAPITAL_FLOWS.filter(f => {
                const fd = (f.date || '').split(' ')[0];
                if (!fd) return false;
                if (start && fd < start) return false;
                if (end && fd > end) return false;
                return true;
            });
        }

        function calcMetrics(filtered, startDate, endDate) {
            if (!filtered.length) return null;
            const first = filtered[0].total_mv;
            const last = filtered[filtered.length - 1].total_mv;
            const start = startDate || filtered[0].date;
            const end = endDate || filtered[filtered.length - 1].date;
            const totalDays = daysBetween(start, end) || 1;

            const flowsInRange = getFlowsInRange(start, end);
            let netInflow = 0;
            let timeWeightedDeposits = 0;
            flowsInRange.forEach(f => {
                const amt = parseFloat(f.amount) || 0;
                const fd = (f.date || '').split(' ')[0] || end;
                if (f.type === 'deposit') {
                    netInflow += amt;
                    const daysIn = daysBetween(fd, end);
                    timeWeightedDeposits += amt * (daysIn / totalDays);
                } else {
                    netInflow -= amt;
                }
            });

            const pnl = last - first;
            const trueReturn = pnl - netInflow;
            const capitalBase = first + timeWeightedDeposits;
            const ret = capitalBase > 0 ? (trueReturn / capitalBase * 100) : 0;

            let peak = first;
            let mdd = 0;
            const dailyRets = [];
            for (let i = 1; i < filtered.length; i++) {
                const prev = filtered[i-1].total_mv;
                const curr = filtered[i].total_mv;
                if (curr > peak) peak = curr;
                const dd = peak > 0 ? (peak - curr) / peak * 100 : 0;
                if (dd > mdd) mdd = dd;
                if (prev > 0) dailyRets.push((curr - prev) / prev * 100);
            }
            const avgRet = dailyRets.length ? dailyRets.reduce((a,b)=>a+b,0)/dailyRets.length : 0;
            const stdRet = dailyRets.length > 1 ? Math.sqrt(dailyRets.reduce((s,r)=>s+(r-avgRet)**2,0)/(dailyRets.length-1)) : 0;
            const sharpe = stdRet > 0 ? (avgRet / stdRet * Math.sqrt(252)) : 0;
            const wins = dailyRets.filter(r => r > 0).length;
            const losses = dailyRets.filter(r => r < 0).length;
            const winRate = dailyRets.length ? (wins / dailyRets.length * 100) : 0;
            const avgWin = wins ? dailyRets.filter(r=>r>0).reduce((a,b)=>a+b,0)/wins : 0;
            const avgLoss = losses ? Math.abs(dailyRets.filter(r=>r<0).reduce((a,b)=>a+b,0)/losses) : 0;
            const profitLoss = avgLoss > 0 ? (avgWin / avgLoss) : (avgWin > 0 ? 999 : 0);
            const retAnn = totalDays > 0 ? (Math.pow(1 + ret/100, 365/totalDays) - 1) * 100 : 0;

            return { first, last, pnl: trueReturn, ret, retAnn, mdd, netInflow, sharpe, winRate, profitLoss, dailyRets };
        }

        function updateMetrics(m) {
            const fmt = (v) => typeof v === 'number' ? v.toLocaleString('zh-CN', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : v;
            const fmtPct = (v) => typeof v === 'number' ? (v >= 0 ? '+' : '') + v.toFixed(2) + '%' : v;
            document.getElementById('metricStartMv').textContent = m ? 'Â¥' + fmt(m.first) : 'â€”';
            document.getElementById('metricEndMv').textContent = m ? 'Â¥' + fmt(m.last) : 'â€”';
            const pnlEl = document.getElementById('metricPnl');
            if (m) {
                pnlEl.textContent = (m.pnl >= 0 ? '+' : '') + 'Â¥' + fmt(m.pnl);
                pnlEl.className = 'value ' + (m.pnl >= 0 ? 'up' : 'down');
            } else pnlEl.textContent = 'â€”';
            const retEl = document.getElementById('metricReturn');
            if (m) {
                retEl.textContent = fmtPct(m.ret);
                retEl.className = 'value ' + (m.ret >= 0 ? 'up' : 'down');
            } else retEl.textContent = 'â€”';
            document.getElementById('metricDrawdown').textContent = m ? m.mdd.toFixed(2) + '%' : 'â€”';
            document.getElementById('metricReturnAnn').textContent = m && m.retAnn != null ? fmtPct(m.retAnn) : 'â€”';
            document.getElementById('metricSharpe').textContent = m && m.sharpe != null ? m.sharpe.toFixed(2) : 'â€”';
            document.getElementById('metricWinRate').textContent = m && m.winRate != null ? m.winRate.toFixed(1) + '%' : 'â€”';
            document.getElementById('metricProfitLoss').textContent = m && m.profitLoss != null ? m.profitLoss.toFixed(2) : 'â€”';
            const netEl = document.getElementById('metricNetInflow');
            if (m && m.netInflow != null) {
                netEl.textContent = (m.netInflow >= 0 ? '+' : '') + 'Â¥' + fmt(m.netInflow);
                netEl.className = 'value ' + (m.netInflow >= 0 ? 'up' : 'down');
            } else netEl.textContent = 'â€”';
        }

        function getFlowDates() {
            return new Set(CAPITAL_FLOWS.map(f => (f.date || '').split(' ')[0]).filter(Boolean));
        }

        function detectAnomalies(daily) {
            const flowDates = getFlowDates();
            const anomalies = [];
            for (let i = 1; i < daily.length; i++) {
                const prev = daily[i - 1].total_mv;
                const curr = daily[i].total_mv;
                if (prev <= 0) continue;
                const pct = (curr - prev) / prev * 100;
                if (Math.abs(pct) >= ANOMALY_THRESHOLD) {
                    const d = daily[i].date;
                    const hasFlow = flowDates.has(d);
                    anomalies.push({ date: d, pct, hasFlow });
                }
            }
            return anomalies;
        }

        function renderFlows(filtered) {
            const start = document.getElementById('dateStart').value;
            const end = document.getElementById('dateEnd').value;
            let flows = CAPITAL_FLOWS;
            if (start) flows = flows.filter(f => (f.date || '').split(' ')[0] >= start);
            if (end) flows = flows.filter(f => (f.date || '').split(' ')[0] <= end);
            flows.sort((a,b) => ((a.date||'').localeCompare(b.date||'')));
            const el = document.getElementById('flowsTimeline');
            if (!flows.length) {
                el.innerHTML = '<div class="timeline-item" style="color:var(--text-secondary)">æš‚æ— è®°å½•ï¼Œè¯·ç¼–è¾‘ capital_flows.json æ·»åŠ å¢æŠ•/èµå›</div>';
                return;
            }
            el.innerHTML = flows.map(f => {
                const cls = f.type === 'deposit' ? 'deposit' : 'withdrawal';
                const icon = f.type === 'deposit' ? 'â¬†ï¸' : 'â¬‡ï¸';
                const typeStr = f.type === 'deposit' ? 'å¢æŠ•' : 'èµå›';
                const sign = f.type === 'deposit' ? '+' : '-';
                const amt = parseFloat(f.amount) || 0;
                const note = f.note ? ` â€” ${f.note}` : '';
                return `<div class="timeline-item ${cls}">${f.date} ${icon} ${typeStr} ${sign}Â¥${amt.toLocaleString()}${note}</div>`;
            }).join('');
        }

        function renderAnomalies(filtered) {
            const anomalies = detectAnomalies(filtered);
            const ul = document.getElementById('anomalyList');
            if (!anomalies.length) {
                ul.innerHTML = '<li style="color:var(--text-secondary)">æœªæ£€æµ‹åˆ°å¼‚å¸¸æ³¢åŠ¨</li>';
                return;
            }
            const unrecorded = anomalies.filter(a => !a.hasFlow);
            ul.innerHTML = anomalies.map(a => {
                const pctStr = (a.pct >= 0 ? '+' : '') + a.pct.toFixed(1) + '%';
                const tag = a.hasFlow ? 'âœ“ å·²è®°å½•' : 'âš  è¯·è¡¥å……åˆ° capital_flows.json';
                const cls = a.hasFlow ? 'style="color:#2ecc71"' : '';
                return `<li ${cls}>${a.date} å¸‚å€¼å˜åŒ– ${pctStr} â€” ${tag}</li>`;
            }).join('');
            if (unrecorded.length) {
                ul.innerHTML += `<li class="anomaly-hint" style="margin-top:12px; border:none">å…± ${unrecorded.length} ä¸ªæ—¥æœŸå¾…ç¡®è®¤</li>`;
            }
        }

        function applyFilter() {
            const start = document.getElementById('dateStart').value;
            const end = document.getElementById('dateEnd').value;
            const daily = aggregateDaily(HISTORY_RAW);
            let filtered = daily;
            if (start) filtered = filtered.filter(d => d.date >= start);
            if (end) filtered = filtered.filter(d => d.date <= end);
            renderChart(filtered);
            updateMetrics(calcMetrics(filtered, start, end));
            renderHistogram(filtered);
            renderVolatility(filtered);
            renderFlows(filtered);
            renderAnomalies(filtered);
            renderDailyTable(filtered);
        }

        function resetRange() {
            const daily = aggregateDaily(HISTORY_RAW);
            if (daily.length) {
                document.getElementById('dateStart').value = daily[0].date;
                document.getElementById('dateEnd').value = daily[daily.length - 1].date;
            } else {
                document.getElementById('dateStart').value = '';
                document.getElementById('dateEnd').value = '';
            }
            applyFilter();
        }

        document.getElementById('btnApply').addEventListener('click', applyFilter);
        document.getElementById('btnReset').addEventListener('click', resetRange);

        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }
        function showPrivateData() {
            document.getElementById('statusText').textContent = 'ğŸŸ¢ å®Œæ•´æ¨¡å¼';
            document.getElementById('loginModal').classList.remove('show');
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('historyGate').classList.remove('gated');
        }
        function showPublicData() {
            document.getElementById('statusText').textContent = 'âšªï¸ å…¬å¼€æ¨¡å¼';
            document.getElementById('historyGate').classList.add('gated');
            document.getElementById('loginModal').style.display = 'flex';
            document.getElementById('loginModal').classList.add('show');
        }
        function handleStatusClick() {
            if (localStorage.getItem('fundAgentLoggedIn') === 'true') {
                if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                    localStorage.removeItem('fundAgentLoggedIn');
                    showPublicData();
                }
            } else {
                document.getElementById('loginModal').style.display = 'flex';
                document.getElementById('loginModal').classList.add('show');
            }
        }
        async function login() {
            const password = document.getElementById('passwordInput').value;
            if (!password) {
                document.getElementById('loginError').textContent = 'è¯·è¾“å…¥å¯†ç ';
                return;
            }
            const hash = await sha256(password);
            if (hash === PASSWORD_HASH) {
                localStorage.setItem('fundAgentLoggedIn', 'true');
                showPrivateData();
                document.getElementById('passwordInput').value = '';
                document.getElementById('loginError').textContent = '';
            } else {
                document.getElementById('loginError').textContent = 'å¯†ç é”™è¯¯';
                setTimeout(() => { document.getElementById('loginError').textContent = ''; }, 2000);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            if (localStorage.getItem('fundAgentLoggedIn') === 'true') {
                showPrivateData();
            } else {
                showPublicData();
            }
            resetRange();
            document.addEventListener('mousemove', e => {
                const tooltip = document.getElementById('tooltip');
                if (e.target.classList && e.target.classList.contains('glossary-term')) {
                    tooltip.innerText = e.target.getAttribute('data-tip') || '';
                    tooltip.style.display = 'block';
                    let x = e.clientX + 10;
                    if (x + 290 > window.innerWidth) x = e.clientX - 300;
                    tooltip.style.left = x + 'px';
                    tooltip.style.top = (e.clientY + 10) + 'px';
                } else {
                    tooltip.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
